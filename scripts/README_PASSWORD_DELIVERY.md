# üîê Password Delivery Script - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç `send_passwords_to_telegram.py` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ Telegram Bot –Ω–∞ –æ—Å–Ω–æ–≤–µ `migration_report.json`.

**–ó–∞–¥–∞—á–∞:** T19 (#00005_20251014_HRYHG)
**–ê–≤—Ç–æ—Ä:** backend-developer
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 20 –æ–∫—Ç—è–±—Ä—è 2025

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Python 3.9+
- Pyrogram (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ)
- `migration_report.json` (—Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º `migrate_users.py`)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `config.py`:
- `API_ID` - Telegram API ID
- `API_HASH` - Telegram API Hash
- `TELEGRAM_BOT_TOKEN` - Token –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
- `SESSION_NAME` - –ò–º—è —Å–µ—Å—Å–∏–∏ –¥–ª—è Pyrogram

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
```bash
cd C:\Users\l0934\Projects\VoxPersona
python scripts\migrate_users.py
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç `src/auth_data/migration_report.json` —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏.

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–æ–ª–µ–π

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏:
```bash
python scripts\send_passwords_to_telegram.py
```

### 3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç –æ—Ç—á–µ—Ç –æ –¥–æ—Å—Ç–∞–≤–∫–µ:
- **–ü—É—Ç—å:** `src/auth_data/password_delivery_report.json`
- **–§–æ—Ä–º–∞—Ç:**
```json
{
  "delivery_date": "2025-10-20T14:32:15.123456",
  "total_users": 5,
  "sent": [
    {
      "telegram_id": 123456789,
      "username": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
      "status": "success"
    }
  ],
  "failed": [
    {
      "telegram_id": 987654321,
      "username": "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞",
      "status": "failed",
      "error": "UserIsBlocked"
    }
  ]
}
```

---

## üì® –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
üîê –í–∞—à –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ –≤ VoxPersona

–ü–∞—Ä–æ–ª—å: a9Kx2LmNpQr8vZ

‚ö†Ô∏è –í–ê–ñ–ù–û:
‚Ä¢ –≠—Ç–æ—Ç –ø–∞—Ä–æ–ª—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ 23 –æ–∫—Ç—è–±—Ä—è 2025, 14:32
‚Ä¢ –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
‚Ä¢ –ù–∏–∫–æ–º—É –Ω–µ —Å–æ–æ–±—â–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å

–î–ª—è –≤—Ö–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /start –∏ –≤–≤–µ–¥–∏—Ç–µ —ç—Ç–æ—Ç –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ.
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã:
1. **–õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:** –ü–∞—Ä–æ–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –¢–û–õ–¨–ö–û –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–µ –≤ –≥—Ä—É–ø–ø—ã)
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –ø–∞—Ä–æ–ª–µ–π:** –°–∫—Ä–∏–ø—Ç –ª–æ–≥–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —É—Å–ø–µ—Ö/–æ—à–∏–±–∫—É, –ù–ï —Å–∞–º–∏ –ø–∞—Ä–æ–ª–∏
3. **–£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø —É–¥–∞–ª–∏—Ç—å `migration_report.json`

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
```bash
# –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—Å–µ—Ö –ø–∞—Ä–æ–ª–µ–π
rm src/auth_data/migration_report.json

# –ò–ª–∏ –Ω–∞ Windows
del src\auth_data\migration_report.json
```

---

## üîß –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### Rate Limiting
- **1 —Å–µ–∫—É–Ω–¥–∞** –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ Telegram API

### Error Handling

| –û—à–∏–±–∫–∞ | –î–µ–π—Å—Ç–≤–∏–µ | Retry |
|--------|----------|-------|
| `UserIsBlocked` | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞) | ‚ùå –ù–µ—Ç |
| `PeerIdInvalid` | –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å (–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π telegram_id) | ‚ùå –ù–µ—Ç |
| `FloodWait` | –ñ–¥–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è, –∑–∞—Ç–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å | ‚úÖ –î–∞ |
| –î—Ä—É–≥–∏–µ `RPCError` | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å + retry —Å exponential backoff | ‚úÖ –î–∞ (–¥–æ 3 —Ä–∞–∑) |

### Retry Mechanism
–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–∫—Ä–æ–º–µ `UserIsBlocked`, `PeerIdInvalid`):
1. **–ü–æ–ø—ã—Ç–∫–∞ 1:** –ë–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
2. **–ü–æ–ø—ã—Ç–∫–∞ 2:** –ó–∞–¥–µ—Ä–∂–∫–∞ 1 —Å–µ–∫—É–Ω–¥–∞
3. **–ü–æ–ø—ã—Ç–∫–∞ 3:** –ó–∞–¥–µ—Ä–∂–∫–∞ 2 —Å–µ–∫—É–Ω–¥—ã
4. **–ü–æ–ø—ã—Ç–∫–∞ 4:** –ó–∞–¥–µ—Ä–∂–∫–∞ 4 —Å–µ–∫—É–Ω–¥—ã (exponential backoff: 2^n)

---

## üìä –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Å–∫—Ä–∏–ø—Ç–∞

```
[2025-10-20 14:30:00] INFO: === VoxPersona Password Delivery Script ===
[2025-10-20 14:30:00] INFO: Migration report –∑–∞–≥—Ä—É–∂–µ–Ω: 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
[2025-10-20 14:30:00] INFO: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–æ–ª–µ–π: 5
[2025-10-20 14:30:01] INFO: Telegram Bot Client –ø–æ–¥–∫–ª—é—á–µ–Ω
[2025-10-20 14:30:01] INFO: PasswordDeliveryService –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
[2025-10-20 14:30:01] INFO: –ù–∞—á–∞–ª–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–æ–ª–µ–π 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
[2025-10-20 14:30:01] INFO: [1/5] –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–æ–ª—è: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (ID: 123456789)
[2025-10-20 14:30:02] INFO: ‚úÖ –ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (ID: 123456789)
[2025-10-20 14:30:03] INFO: [2/5] –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–æ–ª—è: –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞ (ID: 987654321)
[2025-10-20 14:30:04] WARNING: ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞: –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞ (ID: 987654321)
...
[2025-10-20 14:30:15] INFO: –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: 4 —É—Å–ø–µ—à–Ω–æ, 1 –æ—à–∏–±–æ–∫
[2025-10-20 14:30:15] INFO: –û—Ç—á–µ—Ç –æ –¥–æ—Å—Ç–∞–≤–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: src/auth_data/password_delivery_report.json
[2025-10-20 14:30:15] INFO: === Delivery Summary ===
[2025-10-20 14:30:15] INFO: –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 5
[2025-10-20 14:30:15] INFO: –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: 4
[2025-10-20 14:30:15] INFO: –û—à–∏–±–æ–∫: 1
[2025-10-20 14:30:15] INFO:
--- –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ ---
[2025-10-20 14:30:15] INFO:   ‚úÖ –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤ (ID: 123456789)
[2025-10-20 14:30:15] INFO:   ‚úÖ –ê–ª–µ–∫—Å–µ–π –ö—É–∑–Ω–µ—Ü–æ–≤ (ID: 555777999)
...
[2025-10-20 14:30:15] WARNING:
--- –û—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ ---
[2025-10-20 14:30:15] WARNING:   ‚ùå –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞ (ID: 987654321) - –û—à–∏–±–∫–∞: UserIsBlocked
[2025-10-20 14:30:15] WARNING:
‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ï—Å—Ç—å –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ (1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
[2025-10-20 14:30:15] WARNING: –ù–ï –£–î–ê–õ–Ø–ô–¢–ï migration_report.json –¥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—É–¥–∞—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä migration_report.json
–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `example_migration_report.json` —Å –ø—Ä–∏–º–µ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging
```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π migration_report.json
cp scripts/example_migration_report.json src/auth_data/migration_report.json

# 2. –ò–∑–º–µ–Ω–∏—Ç—å telegram_id –Ω–∞ –≤–∞—à –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
# (–≤ src/auth_data/migration_report.json)

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç
python scripts/send_passwords_to_telegram.py
```

---

## ‚ö†Ô∏è Troubleshooting

### –û—à–∏–±–∫–∞: "Migration report –Ω–µ –Ω–∞–π–¥–µ–Ω"
**–ü—Ä–∏—á–∏–Ω–∞:** `migration_report.json` –Ω–µ —Å–æ–∑–¥–∞–Ω
**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `scripts/migrate_users.py`

### –û—à–∏–±–∫–∞: "UserIsBlocked"
**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–º—É `/start`

### –û—à–∏–±–∫–∞: "PeerIdInvalid"
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π telegram_id –∏–ª–∏ –±–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å telegram_id –≤ migration_report.json

### –û—à–∏–±–∫–∞: "FloodWait"
**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram API
**–†–µ—à–µ–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∂–¥–µ—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è

---

## üìù –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

**–§–∞–π–ª:** `scripts/send_passwords_to_telegram.py`
**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~450
**–ö–ª–∞—Å—Å—ã:** 1 (`PasswordDeliveryService`)
**–§—É–Ω–∫—Ü–∏–∏:** 7
**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:** –ü–æ–¥—Ä–æ–±–Ω—ã–µ docstrings –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

- **T18:** `migrate_users.py` - –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –Ω–æ–≤—É—é auth —Å–∏—Å—Ç–µ–º—É
- **T19:** `send_passwords_to_telegram.py` - –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (—Ç–µ–∫—É—â–∏–π)
- **T20:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (end-to-end)

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ê–≤—Ç–æ—Ä:** backend-developer
**–ó–∞–¥–∞—á–∞:** T19 (#00005_20251014_HRYHG)
**–ü—Ä–æ–µ–∫—Ç:** VoxPersona
